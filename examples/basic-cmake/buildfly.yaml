project:
  name: "basic-cmake-project"
  version: "1.0.0"
  variables:
    install_dir: ".buildfly"
    build_type: "Release"
    cxx_compiler: "g++"
    cxx_flags: "-O2 -std=c++17"

dependencies:
  fmt:
    version: "8.0.1"
    source:
      type: "git"
      url: "https://github.com/fmtlib/fmt.git"
      tag: "8.0.1"
    build_system: "cmake"
    cmake_options:
      - "FMT_TEST=OFF"
      - "FMT_DOC=OFF"
      - "CMAKE_POSITION_INDEPENDENT_CODE=ON"
      - "CMAKE_BUILD_TYPE=${BUILD_TYPE}"
    build_commands:
      configure: |
        cmake -B ${BUILD_DIR} \
          -DCMAKE_INSTALL_PREFIX=${INSTALL_DIR} \
          -DCMAKE_BUILD_TYPE=${BUILD_TYPE} \
          -DFMT_TEST=OFF \
          -DFMT_DOC=OFF \
          -DCMAKE_POSITION_INDEPENDENT_CODE=ON
      build: "cmake --build ${BUILD_DIR} --config ${BUILD_TYPE} -j${CPU_CORES}"
      install: "cmake --install ${BUILD_DIR} --config ${BUILD_TYPE}"

  spdlog:
    version: "1.9.2"
    source:
      type: "git"
      url: "https://github.com/gabime/spdlog.git"
      tag: "v1.9.2"
    build_system: "cmake"
    cmake_options:
      - "SPDLOG_BUILD_TESTS=OFF"
      - "SPDLOG_BUILD_EXAMPLE=OFF"
      - "CMAKE_POSITION_INDEPENDENT_CODE=ON"
    build_commands:
      configure: |
        cmake -B ${BUILD_DIR} \
          -DCMAKE_INSTALL_PREFIX=${INSTALL_DIR} \
          -DCMAKE_BUILD_TYPE=${BUILD_TYPE} \
          -DSPDLOG_BUILD_TESTS=OFF \
          -DSPDLOG_BUILD_EXAMPLE=OFF \
          -DCMAKE_POSITION_INDEPENDENT_CODE=ON
      build: "cmake --build ${BUILD_DIR} --config ${BUILD_TYPE} -j${CPU_CORES}"
      install: "cmake --install ${BUILD_DIR} --config ${BUILD_TYPE}"

build_profiles:
  debug:
    variables:
      build_type: "Debug"
      cxx_flags: "-g -O0 -std=c++17"
    dependencies:
      - "fmt"
      - "spdlog"

  release:
    variables:
      build_type: "Release"
      cxx_flags: "-O3 -DNDEBUG -std=c++17"
    dependencies:
      - "fmt"
      - "spdlog"

  minimal:
    variables:
      build_type: "Release"
    dependencies:
      - "fmt"
